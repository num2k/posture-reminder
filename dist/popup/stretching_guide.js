(()=>{var v=(e,t,n)=>new Promise((g,c)=>{var w=r=>{try{u(n.next(r))}catch(m){c(m)}},I=r=>{try{u(n.throw(r))}catch(m){c(m)}},u=r=>r.done?g(r.value):Promise.resolve(r.value).then(w,I);u((n=n.apply(e,t)).next())});var l=[],i=[],s=0,a=document.getElementById("stretching-list"),L=document.getElementById("category-filter"),d=document.getElementById("exercise-modal"),o=document.getElementById("modal-image"),p=document.getElementById("modal-title"),E=document.getElementById("modal-description"),y=document.getElementById("prev-exercise"),f=document.getElementById("next-exercise"),M=document.querySelector(".close-modal");document.addEventListener("DOMContentLoaded",()=>v(void 0,null,function*(){yield i18n.init("stretching"),b(),$()}));function b(){L.querySelectorAll("option").forEach(t=>{let n=t.getAttribute("data-i18n");n&&(t.textContent=i18n.get("stretching",n))})}function $(){chrome.storage.sync.get(["settings"],function(e){let g=((e.settings||{}).language||"en")==="ko"?"../data/exercises_kr.json":"../data/exercises.json";fetch(g).then(c=>c.json()).then(c=>{l=c,i=[...l],k()}).catch(c=>{console.error("Error loading exercises:",c),a.innerHTML=`<div class="no-results">${i18n.get("stretching","failedToLoad")}</div>`})})}function k(){if(i.length===0){a.innerHTML=`<div class="no-results">${i18n.get("stretching","noResults")}</div>`;return}a.innerHTML="",i.forEach((e,t)=>{let n=document.createElement("div");n.className="exercise-card",n.dataset.index=t,n.innerHTML=`
      <div class="card-image">
        <img src="${e.imageUrl}" alt="${e.title}" onerror="this.src='../assets/images/icon128.png'">
      </div>
      <div class="card-content">
        <h2>${e.title}</h2>
        <p>${e.description}</p>
        <span class="category-badge">${T(e.category)}</span>
      </div>
    `,n.addEventListener("click",()=>U(t)),a.appendChild(n)})}function T(e){return i18n.get("stretching",e)||F(e)}function A(e){e==="all"?i=[...l]:i=l.filter(t=>t.category===e),k()}function U(e){s=e;let t=i[e];o.src=t.imageUrl,o.onerror=()=>{o.src="../assets/images/icon128.png"},p.textContent=t.title,E.textContent=t.description,d.style.display="block",document.body.style.overflow="hidden",x()}function h(){d.style.display="none",document.body.style.overflow="auto"}function C(){if(s>0){s--;let e=i[s];o.src=e.imageUrl,o.onerror=()=>{o.src="../assets/images/icon128.png"},p.textContent=e.title,E.textContent=e.description,x()}}function B(){if(s<i.length-1){s++;let e=i[s];o.src=e.imageUrl,o.onerror=()=>{o.src="../assets/images/icon128.png"},p.textContent=e.title,E.textContent=e.description,x()}}function x(){y.disabled=s===0,f.disabled=s===i.length-1,y.style.opacity=s===0?"0.5":"1",f.style.opacity=s===i.length-1?"0.5":"1"}function F(e){return e.charAt(0).toUpperCase()+e.slice(1)}L.addEventListener("change",e=>A(e.target.value));M.addEventListener("click",h);y.addEventListener("click",C);f.addEventListener("click",B);window.addEventListener("click",e=>{e.target===d&&h()});document.addEventListener("keydown",e=>{d.style.display==="block"&&(e.key==="Escape"?h():e.key==="ArrowLeft"?C():e.key==="ArrowRight"&&B())});})();
