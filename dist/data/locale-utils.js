(()=>{var s=(t,n,i)=>new Promise((e,l)=>{var g=o=>{try{d(i.next(o))}catch(f){l(f)}},h=o=>{try{d(i.throw(o))}catch(f){l(f)}},d=o=>o.done?e(o.value):Promise.resolve(o.value).then(g,h);d((i=i.apply(t,n)).next())});var r="en",a={},u=[];function p(){return s(this,null,function*(){try{return a=yield(yield fetch("../data/localization.json")).json(),a}catch(t){return console.error("Failed to load translations:",t),{}}})}function w(){return s(this,null,function*(){return new Promise(t=>{chrome.storage.sync.get(["settings"],function(n){n.settings&&n.settings.language&&(r=n.settings.language),t(r)})})})}function m(t,n){return!a[r]||!a[r][t]||!a[r][t][n]?a.en&&a.en[t]&&a.en[t][n]?a.en[t][n]:n:a[r][t][n]}function c(t){document.querySelectorAll("[data-i18n]").forEach(e=>{let l=e.getAttribute("data-i18n");(e.getAttribute("data-i18n-section")||t)===t&&(e.textContent=m(t,l))}),document.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{let l=e.getAttribute("data-i18n-placeholder");(e.getAttribute("data-i18n-placeholder-section")||t)===t&&(e.placeholder=m(t,l))})}function S(t){return s(this,null,function*(){yield p(),yield w(),u.push(t),c(t),chrome.storage.onChanged.addListener(function(n,i){i==="sync"&&n.settings&&n.settings.newValue.language!==n.settings.oldValue.language&&(r=n.settings.newValue.language,u.forEach(e=>c(e)))})})}function A(t){u.includes(t)||(u.push(t),c(t))}window.i18n={init:S,get:m,translate:c,loadSection:A};})();
