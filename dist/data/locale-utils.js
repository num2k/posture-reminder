(()=>{var s=(t,e,i)=>new Promise((n,l)=>{var g=o=>{try{d(i.next(o))}catch(f){l(f)}},p=o=>{try{d(i.throw(o))}catch(f){l(f)}},d=o=>o.done?n(o.value):Promise.resolve(o.value).then(g,p);d((i=i.apply(t,e)).next())});var r="en",a={},u=[];function w(){return s(this,null,function*(){try{return a=yield(yield fetch("../data/localization.json")).json(),a}catch(t){return console.error("Failed to load translations:",t),{}}})}function h(){return s(this,null,function*(){return new Promise(t=>{chrome.storage.sync.get(["settings"],function(e){e.settings&&e.settings.language&&(r=e.settings.language),t(r)})})})}function m(t,e){return!a[r]||!a[r][t]||!a[r][t][e]?a.en&&a.en[t]&&a.en[t][e]?a.en[t][e]:e:a[r][t][e]}function c(t){document.querySelectorAll("[data-i18n]").forEach(n=>{let l=n.getAttribute("data-i18n");(n.getAttribute("data-i18n-section")||t)===t&&(n.textContent=m(t,l))}),document.querySelectorAll("[data-i18n-placeholder]").forEach(n=>{let l=n.getAttribute("data-i18n-placeholder");(n.getAttribute("data-i18n-placeholder-section")||t)===t&&(n.placeholder=m(t,l))})}function S(t){return s(this,null,function*(){yield w(),yield h(),u.push(t),c(t),chrome.storage.onChanged.addListener(function(e,i){i==="sync"&&e.settings&&e.settings.newValue&&e.settings.oldValue&&e.settings.newValue.language!==e.settings.oldValue.language&&(r=e.settings.newValue.language,u.forEach(n=>c(n)))})})}function A(t){u.includes(t)||(u.push(t),c(t))}window.i18n={init:S,get:m,translate:c,loadSection:A};})();
